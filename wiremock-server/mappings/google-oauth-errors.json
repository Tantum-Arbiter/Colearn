{
  "mappings": [
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "queryParameters": {
          "id_token": {
            "matches": "invalid-.*"
          }
        }
      },
      "response": {
        "status": 400,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "error": "invalid_token",
          "error_description": "Invalid token"
        }
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "queryParameters": {
          "id_token": {
            "matches": "expired-.*"
          }
        }
      },
      "response": {
        "status": 400,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "error": "invalid_token",
          "error_description": "Token has expired"
        }
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "headers": {
          "X-Test-Scenario": {
            "equalTo": "service-unavailable"
          }
        }
      },
      "response": {
        "status": 503,
        "fixedDelayMilliseconds": 3000,
        "headers": {
          "Content-Type": "application/json",
          "Retry-After": "60"
        },
        "jsonBody": {
          "error": {
            "code": 503,
            "message": "Service Unavailable",
            "status": "UNAVAILABLE"
          }
        }
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "headers": {
          "X-Test-Scenario": {
            "equalTo": "timeout"
          }
        }
      },
      "response": {
        "fixedDelayMilliseconds": 10000,
        "status": 200,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "aud": "test-client-id",
          "sub": "google-user-id",
          "email": "test@example.com",
          "email_verified": "true",
          "name": "Test User",
          "picture": "https://example.com/avatar.jpg",
          "iss": "https://accounts.google.com",
          "iat": "{{now}}",
          "exp": "{{now offset='3600'}}"
        },
        "transformers": ["response-template"]
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "headers": {
          "X-Test-Scenario": {
            "equalTo": "rate-limit"
          }
        }
      },
      "response": {
        "status": 429,
        "headers": {
          "Content-Type": "application/json",
          "Retry-After": "60"
        },
        "jsonBody": {
          "error": {
            "code": 429,
            "message": "Rate limit exceeded",
            "status": "RESOURCE_EXHAUSTED"
          }
        }
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "headers": {
          "X-Test-Scenario": {
            "equalTo": "internal-error"
          }
        }
      },
      "response": {
        "status": 500,
        "fixedDelayMilliseconds": 1500,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "error": {
            "code": 500,
            "message": "Internal Server Error",
            "status": "INTERNAL"
          }
        }
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "headers": {
          "X-Test-Scenario": {
            "equalTo": "connection-error"
          }
        }
      },
      "response": {
        "fault": "EMPTY_RESPONSE"
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "headers": {
          "X-Test-Scenario": {
            "equalTo": "malformed-response"
          }
        }
      },
      "response": {
        "status": 200,
        "headers": {
          "Content-Type": "application/json"
        },
        "body": "{ invalid json response"
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "headers": {
          "X-Test-Scenario": {
            "equalTo": "random-failures"
          }
        }
      },
      "response": {
        "status": 200,
        "delayDistribution": {
          "type": "uniform",
          "lower": 100,
          "upper": 5000
        },
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "aud": "test-client-id",
          "sub": "google-user-id",
          "email": "test@example.com",
          "email_verified": "true",
          "name": "Test User",
          "picture": "https://example.com/avatar.jpg",
          "iss": "https://accounts.google.com",
          "iat": "{{now}}",
          "exp": "{{now offset='3600'}}"
        },
        "transformers": ["response-template"],
        "proxyBaseUrl": "{{randomValue type='BOOLEAN' probability=0.3 then='http://localhost:9999' else=''}}"
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPath": "/oauth2/v2/userinfo",
        "headers": {
          "X-Test-Scenario": {
            "equalTo": "service-error"
          }
        }
      },
      "response": {
        "status": 502,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "error": {
            "code": 502,
            "message": "Bad Gateway",
            "status": "UNAVAILABLE"
          }
        }
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPath": "/oauth2/v2/userinfo",
        "headers": {
          "Authorization": {
            "matches": "Bearer invalid-.*"
          }
        }
      },
      "response": {
        "status": 401,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "error": {
            "code": 401,
            "message": "Invalid Credentials",
            "status": "UNAUTHENTICATED"
          }
        }
      }
    },
    {
      "priority": 1,
      "request": {
        "method": "GET",
        "urlPathPattern": "/oauth2/v3/tokeninfo.*",
        "headers": {
          "X-Test-Scenario": {
            "equalTo": "circuit-breaker"
          }
        }
      },
      "response": {
        "status": 503,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "error": {
            "code": 503,
            "message": "Circuit breaker is open",
            "status": "UNAVAILABLE"
          }
        }
      }
    }
  ]
}
